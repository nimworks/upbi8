import{i as m,br as y,cg as w,a8 as z,cr as p,cO as x,bg as M,fg as k,cq as u,fh as T,z as E,fi as N,b2 as P,fj as S,fk as B,bG as L,cd as A,fl as _}from"./app.Dbs6V_q1.js";function O(s,e){if(s.length!==e.length)throw new m({expectedLength:s.length,givenLength:e.length});const i=[];for(let t=0;t<s.length;t++){const g=s[t],o=e[t];i.push(b(g,o))}return y(i)}function b(s,e,i=!1){if(s==="address"){const n=e;if(!w(n))throw new z({address:n});return p(n.toLowerCase(),{size:i?32:null})}if(s==="string")return x(e);if(s==="bytes")return e;if(s==="bool")return p(M(e),{size:i?32:1});const t=s.match(k);if(t){const[n,r,c="256"]=t,a=Number.parseInt(c,10)/8;return u(e,{size:i?32:a,signed:r==="int"})}const g=s.match(T);if(g){const[n,r]=g;if(Number.parseInt(r,10)!==(e.length-2)/2)throw new E({expectedSize:Number.parseInt(r,10),givenSize:(e.length-2)/2});return p(e,{dir:"right",size:i?32:null})}const o=s.match(N);if(o&&Array.isArray(e)){const[n,r]=o,c=[];for(let a=0;a<e.length;a++)c.push(b(r,e[a],!0));return c.length===0?"0x":y(c)}throw new P(s)}function R(s){const{source:e}=s,i=new Map,t=new S(8192),g=new Map,o=({address:n,chainId:r})=>`${n}.${r}`;return{async consume({address:n,chainId:r,client:c}){const a=o({address:n,chainId:r}),f=this.get({address:n,chainId:r,client:c});this.increment({address:n,chainId:r});const h=await f;return await e.set({address:n,chainId:r},h),t.set(a,h),h},async increment({address:n,chainId:r}){const c=o({address:n,chainId:r}),a=i.get(c)??0;i.set(c,a+1)},async get({address:n,chainId:r,client:c}){const a=o({address:n,chainId:r});let f=g.get(a);return f||(f=(async()=>{try{const l=await e.get({address:n,chainId:r,client:c}),d=t.get(a)??0;return d>0&&l<=d?d+1:(t.delete(a),l)}finally{this.reset({address:n,chainId:r})}})(),g.set(a,f)),(i.get(a)??0)+await f},reset({address:n,chainId:r}){const c=o({address:n,chainId:r});i.delete(c),g.delete(c)}}}function $(s){const{address:e,data:i,signature:t,to:g="hex"}=s,o=y([L([{type:"address"},{type:"bytes"},{type:"bytes"}],[e,i,t]),B]);return g==="hex"?o:A(o)}function C(s){const{r:e,s:i}=_.Signature.fromCompact(s.slice(2,130)),t=+`0x${s.slice(130)}`,[g,o]=(()=>{if(t===0||t===1)return[void 0,t];if(t===27)return[BigInt(t),0];if(t===28)return[BigInt(t),1];throw new Error("Invalid yParityOrV value")})();return typeof g<"u"?{r:u(e,{size:32}),s:u(i,{size:32}),v:g,yParity:o}:{r:u(e,{size:32}),s:u(i,{size:32}),yParity:o}}export{R as c,O as e,C as p,$ as s};
