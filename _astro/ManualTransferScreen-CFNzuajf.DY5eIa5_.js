import{db as Y,d7 as I,ec as z,d4 as H,d5 as V,df as b,d6 as a,dd as G,bY as f,ed as J}from"./app.Dbs6V_q1.js";import{r as i}from"./index.Crn7-fJZ.js";import{m as K,b as Q}from"./ModalHeader-CSfzkWxZ.KQF0IT9H.js";import{d as W}from"./Layouts-BlFm53ED.DNAcEX9b.js";import{C as X}from"./QrCode-BkoTqsec.Ok9nSJBs.js";import{t as Z}from"./FundWalletMethodHeader-Dujd1j7J.DOTw7rnz.js";import{i as _}from"./InfoBanner-Dk1KghcK.CXxN86kr.js";import{r as ee}from"./Subtitle-CV-2yKE4.DJhYHDeo.js";import{e as re}from"./Title-BnzYV3Is.B74pnAvd.js";import{j as ae}from"./WalletInfoCard-TfOxho0A.gLlbiR7I.js";import{s as ne}from"./useWalletBalance-BDrbQBDX.DKgA2yGD.js";import{t as D}from"./analytics-mkkvFRju.DOXuftJB.js";import{e as se}from"./getChainName-DjpPdUSc.c2urPd0g.js";import{r as h}from"./getUsdcMintAddress-DFI1hv05.C_5bLXgZ.js";import{t as te}from"./transaction-CnfuREWo.DxjkYrBU.js";import{n as ie}from"./getErc20Balance-D0MGUaOw.CZLXP-aV.js";import{i as M,t as oe}from"./formatters.DtIZsRmK.js";import"./dijkstra.COg3n3zL.js";import"./ErrorMessage-D8VaAP5m.NPlgZ3Xt.js";import"./LabelXs-oqZNqbm_.5zQfQihM.js";import"./Address-BuCMjci7.5xYW3BaW.js";import"./check.BWO2M5QN.js";import"./createLucideIcon.RSj0tFkk.js";import"./copy.Ukg_M5w7.js";import"./shared-FM0rljBt.uRznKemR.js";import"./getFormattedUsdFromLamports-B6EqSEho.C-HCdwKa.js";const Be={component:()=>{let{wallets:c}=Y(),{connectors:w}=I(),A=w.filter(z).flatMap((s=>s.wallets)),{data:d,setModalData:F,navigate:k,lastScreen:U}=H(),{rpcConfig:g,appId:C,createAnalyticsEvent:v,closePrivyModal:E}=I(),y=V(),[r,l]=i.useState(void 0),[B,S]=i.useState(!1),e=d?.funding,{reloadBalance:O}=ne({rpcConfig:g,appId:C,address:e.chainType==="ethereum"?e.address:void 0,chain:e.chainType==="ethereum"?e.chain:void 0}),o=e.chainType==="solana",m=o?e.isUSDC?"USDC":"SOL":e.erc20Address?e.erc20ContractInfo?.symbol:e.chain.nativeCurrency.symbol,$=o?A.find((({address:s})=>s===e.address)):c.find((({address:s})=>b(s)===b(e.address)));if(!e)return F({errorModalData:{error:Error("Couldn't find funding config"),previousScreen:U||"FundingMethodSelectionScreen"},funding:d?.funding,solanaFundingData:d?.solanaFundingData,sendTransaction:d?.sendTransaction}),k("ErrorScreen"),a.jsx(a.Fragment,{});i.useEffect((()=>{let s=o?async function(){if(e.chainType!=="solana")return;let n=y.solanaRpcs[e.chain];n?(e.isUSDC?(async function({rpc:p,address:t,mintAddress:q}){let N=await p.getTokenAccountsByOwner(t,{mint:q},{encoding:"jsonParsed",commitment:"confirmed"}).send(),j=N.value[0]?.account;return j?BigInt(j.data.parsed.info.tokenAmount.amount):0n})({rpc:n.rpc,address:e.address,mintAddress:h(e.chain)}):G({rpc:n.rpc,address:e.address})).then((p=>{let t=BigInt(p);r&&t>r&&(S(!0),v({eventName:D,payload:{provider:"manual",status:"success",chainType:"solana",address:$?.address,value:e.isUSDC?f(t-r,6):f(t-r,9),token:e.isUSDC?"USDC":"SOL"}})),l(t)})):console.warn("Unable to load solana rpc, skipping balance")}:async function(){e.chainType==="ethereum"&&(async()=>{if(!e.erc20Address)return await O()??BigInt(0);{let{balance:n}=await ie({chain:e.chain,address:e.address,erc20Address:e.erc20Address,rpcConfig:g,appId:C});return n}})().then((n=>{r&&n>r&&(S(!0),v({eventName:D,payload:{provider:"manual",status:"success",chainType:"ethereum",address:$?.address,chainId:e.chain.id,value:f(n-r,e.erc20ContractInfo?.decimals??18),token:e.erc20ContractInfo?.symbol??e.erc20Address??"ETH"}})),l(n)})).catch((()=>l(void 0)))},R=setInterval(s,2e3);return s(),()=>clearInterval(R)}),[r]);let L=i.useMemo((()=>r==null?"":e.isUSDC?M({amount:r,decimals:6}):o?te(r,3,!0,!0):e.erc20ContractInfo?.decimals!=null?M({amount:r,decimals:e.erc20ContractInfo.decimals}):oe({wei:r})),[r,o,e]),u=e.chainType==="ethereum"?e.chain.name:se(e.chain),x=i.useMemo((()=>e.uiConfig?.receiveFundsTitle===""?null:a.jsx(re,{children:e.uiConfig?.receiveFundsTitle??`Receive ${e.amount} ${m??""}`.trim()})),[e.uiConfig?.receiveFundsTitle,e.amount,m]),T=i.useMemo((()=>e.uiConfig?.receiveFundsSubtitle===""?null:a.jsx(ee,{children:e.uiConfig?.receiveFundsSubtitle??`Scan this code or copy your wallet address to receive funds on ${u}.`})),[e.uiConfig?.receiveFundsSubtitle,u]),P=e.chainType==="solana"&&e.isUSDC&&h(e.chain)?`?spl-token=${h(e.chain)}`:"";return a.jsxs(a.Fragment,{children:[a.jsx(Z,{}),x,T,a.jsxs(W,{style:{gap:"1rem",margin:x||T?"1rem 0":"0"},children:[a.jsx(X,{url:`${e.chainType}:${e.address}${P}`,size:200,squareLogoElement:de}),a.jsxs(_,{theme:y.appearance.palette.colorScheme,children:["Make sure to send funds on ",u,"."]}),a.jsx(ae,{title:"Your wallet",errMsg:void 0,showCopyButton:!0,balance:`${L} ${m}`,address:e.address}),B&&a.jsx(K,{onClick:()=>E({shouldCallAuthOnSuccess:!1,isSuccess:!0}),children:"Continue"})]}),a.jsx(Q,{})]})}};let de=({...c})=>a.jsx(J,{color:"black",...c});export{Be as ManualTransferScreen,Be as default};
