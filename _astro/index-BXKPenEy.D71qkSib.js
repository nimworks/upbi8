import{d7 as v,d4 as A,e7 as F,e8 as w,e9 as M,ea as S,eb as x}from"./app.Dbs6V_q1.js";import{r as u}from"./index.Crn7-fJZ.js";import{t as y}from"./analytics-mkkvFRju.DOXuftJB.js";const f="moonpay";function I(t){return parseFloat(t)}function q(t,s=!1){let[g,p]=u.useState(null),{createAnalyticsEvent:i}=v(),{data:n,navigate:d,setModalData:c}=A(),l=n?.funding,r=u.useRef(0);return u.useEffect((()=>{let o=setInterval((async()=>{if(t)try{let[e]=await(async function(h,m){return F(`${m?w:M}/transactions/ext/${h}`,{query:{apiKey:m?S:x}})})(t,s),a=e.status==="waitingAuthorization"&&e.paymentMethod==="credit_debit_card"?"pending":e.status;if(["failed","completed","awaitingAuthorization"].includes(a)&&(i({eventName:y,payload:{status:a,provider:f,paymentMethod:e.paymentMethod,cardPaymentType:e.cardPaymentType,currency:e.currency?.code,baseCurrencyAmount:e.baseCurrencyAmount,quoteCurrencyAmount:e.quoteCurrencyAmount,feeAmount:e.feeAmount,extraFeeAmount:e.extraFeeAmount,networkFeeAmount:e.networkFeeAmount,isSandbox:s}}),clearInterval(o)),a==="failed"||a==="serviceFailure")return c({funding:{...l,errorMessage:"Something went wrong adding funds from Moonpay. Please try again or use another method to fund your wallet."},solanaFundingData:n?.solanaFundingData}),void d("FundingMethodSelectionScreen");p(a)}catch(e){e.response?.status!==404&&(r.current+=1),r.current>=3&&(i({eventName:y,payload:{status:"serviceFailure",provider:f}}),clearInterval(o),c({funding:{...l,errorMessage:"Something went wrong adding funds from Moonpay. Please try again or use another method to fund your wallet."},solanaFundingData:n?.solanaFundingData}),d("FundingMethodSelectionScreen"))}}),3e3);return()=>clearInterval(o)}),[t,r]),g}export{I as l,q as y};
