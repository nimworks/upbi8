import{d4 as Xe,d7 as Y,dz as et,d5 as tt,d6 as s,dF as he,c as nt,h as at,eq as st,er as it,df as rt,bS as ot,dv as lt,es as ge,et as Ie,eu as ut,ev as pt,by as dt,bv as ct,cU as mt,dr as ve}from"./app.Dbs6V_q1.js";import{r as a}from"./index.Crn7-fJZ.js";import{d as ye}from"./Address-BuCMjci7.5xYW3BaW.js";import{c as yt}from"./useGetTokenPrice-YObgUU6L.Bdidc-9R.js";import{s as ft}from"./useWalletBalance-BDrbQBDX.DKgA2yGD.js";import{n as bt}from"./getErc20TokenInfo-CZJTqd4c.BNXWnBuE.js";import{t as Tt}from"./formatErc20TokenAmount-BuPk9xcy.CkAr4Oc0.js";import{c as fe,o as Q,i as ht}from"./ethers-DrSqg5wi.D-a06N_R.js";import{ErrorScreenView as gt}from"./ErrorScreen-8UMMZ6is.0ylxDhjt.js";import{T as ke,b as xe,m as It}from"./ModalHeader-CSfzkWxZ.KQF0IT9H.js";import{a as vt}from"./JsonTree-aPaJmPx7.BOS6sB7r.js";import{n as kt,Q as xt}from"./TransactionErrorView-C6AZ1RC0.CHEYFltS.js";import{s as Et}from"./Layouts-BlFm53ED.DNAcEX9b.js";import{n as Mt}from"./ScreenHeader-CHmc4-Lu.CDB8Kfz5.js";import{$ as St}from"./TransactionDetails-BMVu0qlz.59B78Oj6.js";import{t as Ft}from"./transfer-6YztDh-t.DU6hH7CZ.js";import{i as _t}from"./formatters.DtIZsRmK.js";import"./check.BWO2M5QN.js";import"./createLucideIcon.RSj0tFkk.js";import"./copy.Ukg_M5w7.js";import"./useGetSolPrice-DwwjjGbd.Cs3YiPXK.js";import"./reservoir-0wfhnc0j.e4oV4U26.js";import"./ScreenLayout-C2Le_YIv.CCTYs10k.js";import"./Screen-5StC6JLQ.BNbtfsff.js";import"./index-Dq_xe9dz.CYFAvuPJ.js";import"./lock.RVFbxoA7.js";import"./Value-tcJV9e0L.CCQPdIyi.js";import"./LoadingSkeleton-U6-3yFwI.DhgKuR2U.js";import"./ErrorMessage-D8VaAP5m.NPlgZ3Xt.js";import"./LabelXs-oqZNqbm_.5zQfQihM.js";import"./Subtitle-CV-2yKE4.DJhYHDeo.js";import"./Title-BnzYV3Is.B74pnAvd.js";import"./WalletInfoCard-TfOxho0A.gLlbiR7I.js";import"./shared-FM0rljBt.uRznKemR.js";import"./Checkbox-BhNoOKjX.CsfsqpBs.js";import"./ErrorBanner-CQERa7bL.BqgviVhf.js";import"./ExclamationCircleIcon.CBeQh4pz.js";import"./WarningBanner-c8L53pJ2.BDeOScMT.js";import"./ExclamationTriangleIcon.CbWlQoeb.js";import"./ChevronDownIcon.zw1eklKi.js";import"./WalletLink-CZTmkBKu.CwUyBa3G.js";import"./getFormattedUsdFromLamports-B6EqSEho.C-HCdwKa.js";import"./transaction-CnfuREWo.DxjkYrBU.js";let Ct=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],Nt=ve.div`
  display: flex;
  flex-direction: column;
  min-height: 72px;
`;var wt=({onBack:e,details:r})=>s.jsxs(Nt,{children:[s.jsx(ke,{backFn:e}),s.jsx(vt,{data:r}),s.jsx(xe,{})]});let $t=({gasUsed:e,effectiveGasPrice:r})=>{if(e&&r)try{return mt(e*r)}catch{return}};const At=({txn:e,receipt:r,transactionInfo:p,onClose:d,tokenPrice:t,tokenSymbol:i,receiptHeader:c,receiptDescription:T})=>s.jsxs(s.Fragment,{children:[s.jsx(ke,{onClose:d}),s.jsx(Mt,{title:c??"Transaction complete!",description:T??"You're all set."}),s.jsx(St,{tokenPrice:t,from:r.from,to:r.to,gas:$t(r),txn:e,transactionInfo:p,tokenSymbol:i}),s.jsx(pt,{}),s.jsx(jt,{loading:!1,onClick:d,children:"All Done"}),s.jsx(Et,{}),s.jsx(xe,{})]});let jt=ve(It)`
  && {
    margin-top: 24px;
  }
  transition:
    color 350ms ease,
    background-color 350ms ease;
`;const Ot=[{constant:!1,inputs:[{name:"_salt",type:"bytes32"},{name:"_initializer",type:"bytes"}],name:"deployAccount",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Rt=[{name:"from",type:"address"},{name:"param2",type:"address"},{name:"param3",type:"bytes"},{name:"param4",type:"tuple",components:[]},{type:"tuple",components:[{name:"param5",type:"address"},{name:"param6",type:"uint256"},{name:"param7",type:"uint256"},{name:"encodedInitData",type:"bytes"}]}],Dt=[{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Pt=[{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"payable",type:"function"}],qt=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Bt=[{constant:!1,inputs:[{name:"_operator",type:"address"},{name:"_approved",type:"bool"}],name:"setApprovalForAll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Ut=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Lt=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenIds",type:"uint256[]"},{name:"_amounts",type:"uint256[]"},{name:"_data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Vt=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"},{name:"_amount",type:"uint256"},{name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Ee=(e,r)=>{let p=x(Dt,e);if(p)return{action:"approve",functionName:"approve",isErc20Ish:!0,isNFTIsh:!1,spender:p.args[0],amount:p.args[1]};let d=x(Ft,e);if(d)return{action:"transfer",functionName:"transfer",isErc20Ish:!0,isNFTIsh:!1,transferTo:d.args[0],amount:d.args[1]};if(!r)return{action:"transaction",functionName:"",isErc20Ish:!1,isNFTIsh:!1};let t=x(Ot,e);if(t&&typeof t.args[1]=="string"){let l=Ht(t.args[1]);if(l&&l[4].encodedInitData)return Ee(l[4].encodedInitData,r)}let i=x(Bt,e);if(i)return{action:"approve",functionName:"setApprovalForAll",isNFTIsh:!0,isErc20Ish:!1,operator:i.args[0],approved:i.args[1]};let c=x(Ut,e);if(c)return{action:"transfer",functionName:"transferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:c.args[0],transferTo:c.args[1],tokenId:c.args[2]};let T=x(qt,e);if(T)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:T.args[0],transferTo:T.args[1],tokenId:T.args[2]};let I=x(Vt,e);if(I)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:I.args[0],transferTo:I.args[1],tokenId:I.args[2],amount:I.args[3]};let h=x(Lt,e);if(h)return{action:"batch transfer",functionName:"safeBatchTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:h.args[0],transferTo:h.args[1],tokenIds:h.args[2],amounts:h.args[3]};let g=x(Pt,e);return g?{action:"mint",functionName:g.functionName,isNFTIsh:!0,isErc20Ish:!1,args:g.args}:{action:"transaction",isErc20Ish:!1,isNFTIsh:!1}};let x=(e,r)=>{try{let p=dt({abi:e,data:r});return{functionName:p.functionName,args:p.args||[]}}catch{return null}},Ht=e=>{try{if(typeof e=="string")return ct(Rt,`0x${e.slice(10)}`)}catch{return null}},K=e=>`${parseFloat(e).toFixed(2)}`;function Gt(e,r){let p=[],d=new Map;if(e){for(let t of e)if(t.in[0]){let i;i=t.asset.type==="ERC721"||t.in[0].value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name,nftCount:t.in.length}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.in[0].value,symbol:t.asset.symbol,usdValue:t.in[0].usd_price?K(t.in[0].usd_price):void 0,decimals:t.asset.decimals},p.push(i)}else if(t.out[0]?.value){let i;i=t.asset.type==="ERC721"||t.out[0].value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.out[0].value,symbol:t.asset.symbol,usdValue:t.out[0].usd_price?K(t.out[0].usd_price):void 0,decimals:t.asset.decimals},d.has(i.id)||d.set(i.id,i)}}for(let t of r)for(let i of Object.keys(t.spenders)){let c;c=t.asset.type==="ERC721"||t.spenders[i]?.value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.spenders[i]?.value,symbol:t.asset.symbol,usdValue:t.spenders[i]?.usd_price?K(t.spenders[i]?.usd_price):void 0,decimals:t.asset.decimals},d.has(c.id)||d.set(c.id,c)}return{assetsIn:p,assetsOut:Array.from(d.values())}}const Wt=(e,r,p,d)=>{let[t,i]=a.useState(null),{walletProxy:c}=Y();return a.useEffect((()=>{t&&i(null),(async()=>{if(!c||!r)return null;let T=[],I=!0,h=await ut(e,p,r,d).catch((g=>(g.message&&g.message.includes("Insufficient balance for transaction")||g.message&&g.message.includes("Insufficient funds for gas * price + value")||g.details&&g.details.includes("insufficient funds")?I=!1:T.push(g),e)));return{tx:h,totalGasEstimate:h.gas,hasFunds:I,errors:T}})().then(i)}),[e]),t};let be=new he(new ge("There was an issue preparing your transaction",Ie.E32603_DEFAULT_INTERNAL_ERROR.eipCode)),Te=(e,r)=>e?.sendTransaction?"transactionRequest"in e.sendTransaction?e.sendTransaction.transactionRequest:e.sendTransaction.transactionRequests[r]:void 0;const Dn={component:()=>{let{data:e,onUserCloseViaDialogOrKeybindRef:r,setModalData:p,navigate:d}=Xe(),{client:t,rpcConfig:i,chains:c,closePrivyModal:T,walletProxy:I,showFiatPrices:h}=Y(),{user:g}=et(),l=tt(),[v,J]=a.useState(0),[A,Me]=a.useState(0),[o,Z]=a.useState(Te(e,v)),[S,Se]=a.useState(null),[X,ee]=a.useState(),[P,te]=a.useState(!1),[q,Fe]=a.useState(null),[ne,_e]=a.useState(null),[N,ae]=a.useState(null),[B,Ce]=a.useState(void 0),[Ne,U]=a.useState(void 0),[we,se]=a.useState(!1),[ie,re]=a.useState(!1),[$e,j]=a.useState([]),[Ae,je]=a.useState([]),[O,L]=a.useState("uninitiated"),[Oe,Re]=a.useState(void 0);if(!o||!e?.sendTransaction||!e?.sendTransaction)return s.jsx(gt,{error:Error("Invalid transaction request"),allowlistConfig:l.allowlistConfig,onRetry:()=>{e?.sendTransaction?.onFailure(be),T({shouldCallAuthOnSuccess:!1})}});let{transactingWalletAddress:w}=e.sendTransaction,k=a.useMemo((()=>c.find((n=>Number(n.id)===Number(o.chainId)))),[o.chainId]),$=k?.nativeCurrency.symbol??"ETH",f=a.useMemo((()=>Ee(o.data,!!l.embeddedWallets.extendedCalldataDecoding)),[o.data]),{action:E,isErc20Ish:C,isNFTIsh:De,functionName:R}=f,{toAddress:Pe,tokenAddress:oe}=a.useMemo((()=>({toAddress:f.isErc20Ish?f.transferTo:o.to??void 0,tokenAddress:f.isErc20Ish?o.to:void 0})),[f]);a.useEffect((()=>{o.to&&k&&C&&bt({address:o.to,chain:k,rpcConfig:l.rpcConfig,privyAppId:l.id}).then(Se).catch(console.error)}),[o.to,k]);let{tokenPrice:F,isTokenPriceLoading:qe}=yt(o.chainId),{balance:le}=ft({rpcConfig:l.rpcConfig,appId:l.id,address:w,chain:k}),ue=(function({rpcConfig:n,appId:m,address:b,chain:y,tokenInfo:M}){let{chains:Ye}=Y(),[W,Je]=a.useState(null),[Ze,ce]=a.useState(!1),z=a.useMemo((()=>{let _=y||Ye[0];if(_)return nt({chain:y,transport:at(st(_,n,m))})}),[y,n,m]),me=a.useCallback((async()=>{if(b&&z&&M.address)try{return ce(!0),await z.readContract({address:M.address,abi:Ct,functionName:"balanceOf",args:[b]})}catch(_){console.error(_)}finally{ce(!1)}}),[z,b,M?.address,y]);return a.useEffect((()=>{me().then((_=>_!=null&&Je(_)))}),[me]),{balance:W,isLoading:Ze&&W==null,formattedBalance:_t({amount:W??BigInt(0),decimals:M.decimals})}})({rpcConfig:l.rpcConfig,appId:l.id,address:w,tokenInfo:{address:oe||"",decimals:S?.decimals??18},chain:k}),pe=a.useMemo((()=>it(Number(o.chainId),c,i,{appId:l.id})),[o.chainId,i]),u=Wt(o,w,pe,e?.sendTransaction?.prepareTransactionRequest);a.useEffect((()=>{Z(Te(e,v))}),[v]),a.useEffect((()=>{e.sendTransaction?.getIsSponsored?e.sendTransaction.getIsSponsored().then(ee).catch(console.error):ee(!1)}),[e.sendTransaction.getIsSponsored]);let D=()=>{if(!P)return q?e?.sendTransaction?.onSuccess({hash:q}):N||u?.errors[0]?e?.sendTransaction?.onFailure(N??u?.errors[0]??be):e?.sendTransaction?.onFailure(new he(new ge("The user rejected the request",Ie.E4001_USER_REJECTED_REQUEST.eipCode))),T({shouldCallAuthOnSuccess:!1})};r.current=D;let V=!!(e.funding&&e.funding.supportedOptions.length>0),Be=fe(BigInt(u?.totalGasEstimate??0n),$),Ue=h&&F?Q(BigInt(u?.totalGasEstimate??0n),F):void 0,Le=fe(le??0n,$,void 0,!0),Ve=h&&F?Q(le??0n,F):void 0,He=S&&!ue.isLoading&&C&&E!=="approve"?`${ue.formattedBalance} ${S.symbol}`:void 0,H=e.sendTransaction?.uiOptions?.transactionInfo?.title;H||(H=E==="approve"?C?"Confirm address":"Confirm action":`Approve ${E}`);let Ge=a.useMemo((()=>{if(e.sendTransaction?.uiOptions?.description)return e.sendTransaction?.uiOptions?.description;if(E==="approve"&&R==="setApprovalForAll"&&f.approved){let n=s.jsx(ye,{address:f.operator||"",url:k?.blockExplorers?.default?.url});return s.jsxs(s.Fragment,{children:[l.name," would like your permission for ",n," to transfer tokens on your behalf."]})}if(E==="approve"&&R==="setApprovalForAll"&&!f.approved){let n=s.jsx(ye,{address:f.operator||"",url:k?.blockExplorers?.default?.url});return s.jsxs(s.Fragment,{children:[l.name," would like your permission to revoke permissions of ",n," from transferring tokens on your behalf."]})}return C&&E==="approve"||C&&E==="approve"?`${l.name} would like your permission for ${rt(f.spender)} to spend tokens on your behalf.`:`${l.name} wants your permission to approve the following transaction.`}),[l.name,C,f,e.sendTransaction?.uiOptions.description,R]),We=e.sendTransaction?.uiOptions?.transactionInfo?.contractInfo?.imgUrl?s.jsx("img",{src:e.sendTransaction.uiOptions.transactionInfo.contractInfo.imgUrl,alt:e.sendTransaction.uiOptions.transactionInfo.contractInfo.imgAltText}):null,G=!(!u||u.errors[0]||u.hasFunds||X!==!1),de=G&&V,ze=de?"Add funds":e.sendTransaction?.uiOptions?.buttonText||(v<A?"Continue":"Approve"),Qe=n=>{if(!n)throw Error("Transaction scan failed");if(n.validation.status==="Success"&&(n.validation.result_type==="Benign"?U("safe"):n.validation.result_type==="Warning"?U("warn"):n.validation.result_type==="Malicious"&&(U("error"),re(!0))),n.simulation.status!=="Success")throw Error("Simulation failed");{Ce(n.simulation.params);let{assetsIn:m,assetsOut:b}=Gt(n.simulation.assets_diffs,n.simulation.exposures);if(b.length===0&&m.length===0)throw Error("No tokens found");j(b),je(m)}};if(a.useEffect((()=>{e.sendTransaction?.scanTransaction&&l.embeddedWallets.transactionScanning.enabled&&O==="uninitiated"&&(L("in progress"),e.sendTransaction.scanTransaction().then((n=>{Qe(n),L("completed")})).catch((()=>L("failed"))))}),[!!e.sendTransaction?.scanTransaction]),a.useEffect((()=>{e.sendTransaction?.scanTransaction&&O!=="failed"||((n,m,b)=>{if(Me((y=>y?.sendTransaction?"transactionRequest"in y.sendTransaction?0:y.sendTransaction.transactionRequests.length-1:0)(e)),m.isErc20Ish&&m.amount&&b){let y=Tt({amount:m.amount,decimals:b.decimals});Re(y),j([{value:y,symbol:b?.symbol,decimals:b?.decimals}])}else if(n.value){let y=BigInt(n.value),M=F?Q(y,F):void 0;j(h&&M?[{value:M}]:[{value:ht(y),symbol:$,decimals:18,usdValue:M}])}else j(h?[{value:"$0"}]:[{value:"0",symbol:$,decimals:18}])})(u?.tx??o,f,S)}),[o,u?.tx,f,S,O]),ne)return s.jsx(At,{txn:u?.tx??o,onClose:D,receipt:ne,transactionInfo:e.sendTransaction?.uiOptions.transactionInfo,tokenPrice:F,tokenSymbol:$,receiptHeader:e.sendTransaction?.uiOptions.successHeader,receiptDescription:e.sendTransaction?.uiOptions.successDescription});if(N)return s.jsx(kt,{transactionError:N,transactionHash:q??void 0,chainType:"ethereum",chainId:u?.tx.chainId??o.chainId,onClose:D,onRetry:({resetNonce:n})=>{ae(null);let m={...u?.tx??o};n&&(m.nonce=void 0),Z(m)}});let Ke=A!==0&&typeof v=="number"&&v!==0?()=>{J(v-1)}:void 0;return we&&B?s.jsx(wt,{details:B,onBack:()=>se(!1)}):s.jsx(xt,{transactionIndex:v,onBack:Ke,maxIndex:A,disabled:G&&!V||ie,isSubmitting:P,submitError:N,isPreparing:!u,isTokenPriceLoading:qe,isTokenContractInfoLoading:!De&&!S,prepareError:u?.errors[0],symbol:S?.symbol,chain:k,img:We,title:H,subtitle:Ge,txValue:o.value,fee:Ue??Be,isSponsored:X,from:w??"",to:Pe,tokenAddress:oe??void 0,network:l.chains.find((n=>n.id===o.chainId))?.name??"",transactionDetails:{...f,formattedAmount:Oe},cta:ze,missingFunds:G,action:E,balance:He??Ve??Le,onClose:D,onClick:de?async()=>{if(!w)return;if(!V)throw Error("Funding wallet is not enabled");let n="FundingMethodSelectionScreen";p({...e,funding:{...e.funding,methodScreen:n,chainType:"ethereum",amount:ot(BigInt(u?.tx.value??0)+BigInt(u?.totalGasEstimate?.toString()??0)),chain:k},solanaFundingData:e?.solanaFundingData}),d(n)}:async()=>{if(v<A)J(v+1);else{te(!0);try{let n=await t.getAccessToken();if(P||!n||!I||!g)return;let m=await e.sendTransaction.onConfirm({transactionRequest:u?.tx??o});if(Fe(m),e.sendTransaction?.signOnly)return await new Promise((y=>setTimeout(y,lt))),e?.sendTransaction?.onSuccess({hash:m}),T({shouldCallAuthOnSuccess:!1});let b=await pe.waitForTransactionReceipt({hash:m});if(b.status==="reverted")throw Error("Transaction failed");_e(b)}catch(n){console.warn({transaction:u?.tx??o,error:n}),ae(n)}finally{te(!1)}}},validation:Ne,hasScanDetails:!!B,setIsScanDetailsOpen:se,preventMaliciousTransaction:ie,setPreventMaliciousTransaction:re,tokensSent:$e,tokensReceived:Ae,isScanning:O==="in progress",isCancellable:e.sendTransaction?.uiOptions?.isCancellable??!1,functionName:R})}};export{Dn as SendTransactionScreen,Dn as default};
